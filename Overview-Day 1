https://vta.cybbh.space/project/
alex.j.bonestroo77	Domain: ipa
5E...!20011776!76!!
http://10.50.29.204:3000	-	RocketChat: Bonestroo_14
Student Number: 14
Class Leader: Lt Summers	440-668-0828
Shared Drive: https://drive.google.com/drive/folders/1hwiPkMVWgvbtoUj5Q4Wli_TB-T_ZPN3F?usp=drive_link
Links and Tips: https://docs.google.com/document/d/1Bi-lypKlbAS3HkK2-ictdlJb3A9nR-yZ-OapbA8iRD4/edit

Reporting
=========================================================================================================================================================================================
Report when you have as much as you can about what you are reporting
MC needs to be informed of all things that impact the risk of the op
YOU are expected to be the technical expert - MC assumes the risk but does not absolve you of any issues that arise associated with that risk
When reporting items, it is imperative to have as much information about the non-standard item as you can gather. This is a benefit to yourself and the Mission Commander to ensure that you understand what the item is and what it’s capable of, and ensure that you can verbalize that to the MC
any action that is not listed on the Mission Plan, you must get authorization from the Mission Commander

Reports to MC (Risk=MC):
  Verify all IP addresses on mission plan before beginning operation
  All connections to each target
  All disconnections from each target
  Collecting a 10 MB file or larger
  Logged on Privileged Users
  Unknown processes/files/jobs*
  Malware or Security Product
  Removing anything from target
  Placing any file on target
  Changing anything on a target
  Adding an IP to the mission plan
  Encountering an unexpected OS  (Unexpected OS not version)
  Any form of abnormal/remote logging*
  Verification of T10 effect immediately before emplacing it
  Taking any action not identified in the mission plan
  Provide details for DEBRIEF after the mission
  Anything that might change the risk on target

Reports to Non-Standard Database (NSDB):
  Any risk reported to the MC (malware, logging, etc) should have an NSDB entry
  Unlike other reports, the NSDB entry is not written for the present, but the future
  More detailed than the MC report
  Documents all known risks in a project
  Allows analysts to better plan operations
  Allows for a more informed operation approval process
  Allows for better OPSEC for fellow operators
  Allows operator to express opinions and make risk recommendations to leadership based on what was observed

Malware Reportable Items:
Malware is defined as any software that is installed on a computer UNKNOWN to the system administrator and WEAKENS the overall security posture of the system
  Process name/options, PID, Parent ID, user, and hash
  File type of malware binary and supporting files
  Associated logs generated by malware
  Location and lines of any persistence mechanisms
  Full path of malware files or support files
  Network connections opened/established by malware
  Identifiable text
  Modules loaded by malware
  Brief description of malware purpose/actions and capabilities
  Recommendation - Do we need to be concerned or adjust our plans?

Abnormal Logging Reportable Items:
Abnormal logging is defined as any logging that occurs outside of the operating system's default values and includes remote logging, network logging, process logging, et cetera
  Provide process name/options, PID, Parent ID, user
  Provide location of configuration file and it's abnormal or irregular contents
  Provide hostname or IP of where logs are being sent
  Provide any network connections opened/established by abnormal logging
  Provide brief description of the abnormal, irregular or remote logging
  Recommendation - Do we need to be concerned or adjust our plans?

Security Products Reportable Items:
Security products are well-defined software programs that are either default to the operating system or are installed by the computer owner for the strict purpose of finding/blocking/removing malicious (as seen by the computer administrator) software
  Name and version of the product
  Primary registry key
  Installation folder
  Directory location of associated logs
  Timestamp of all associated log files
  Cloud based?; yes or no
  Can we read the logs?; yes or no
    -If Yes, put the most recent 5 lines of logs in your NSDB File
    -If No, why?
  Recommendation - Do we need to be concerned or adjust our plans?

Privileged User Reportable Items:
A privileged user is a user with the access and ability to detect on net activities and take action to hinder, stop, or prevent it
  Target - Where did you see this user?
  User - What is their username?
  Access time - How long have they been on?
  Access method - Did they access locally? Remotely?
  Provide all relevant details
  Privileges - What are they capable of doing?
  Activity - What are they currently doing?
  Recommendation - Do we need to be concerned? Do we need to adjust our plans?

DEBRIEF (Mission Report) - A mission summary submitted to the MC for awareness purposes
DEBRIEF Template:
Operator: <your name>
Operation: <name of operation>
MC: <name of MC>
Analyst: <name of analyst>
Description: <two-three sentence overall description of operation followed by a minimum of one sentence per target.>

Reports to Analyst:
Your analyst is the Subject Matter expert on all things minus the technical information for the operation
They are also the network SME. They know the proper routes and hops to take to get to the endpoints
Your analyst will not be able to help you with any technical issues that arise; This includes syntax
They will be able to assist you with items from the mission plan that are not explicitly written, such as missing creds and possibly missing IPs and ports
Remember: they are the ones that write the Mission Plans. Any questions or concerns that you have about the mission and/or the mission plan should be addressed with them
  Target's network information (IP and MAC addresses) upon connection
  Completion of mission plan tasks

Contact SWO for any network/device issues within Blue space

Preparation
=========================================================================================================================================================================================
Mission Materials:
  Anything that contains information that will aid your understanding and performance of the operation and mission, to include but not limited to...
  The Mission Plan
  Mission Profiles
  Mission History
  Previous Op Notes
  Non-Standard Database (NSDB)
  Guidance
  Daily Read
  Other Section Specific Information

Mission Plan:
  ADMIN Block: The who, what, and when of an operation
  Type of Operation: What is the nature of the operation?
  Objective: The desired actions and outcomes of a mission in broad strokes.
  Tools/Techniques: A list of approved tools and techniques (scp, nmap, ssh masquerades, etc) intended to be used to complete the mission.
  Credentials: Known or suspected credentials that may be used, as well as insight into credential postures
  Prior Approvals: Pre-assumed risk for commands and techniques, typically for commands required to ensure mission is completed completely and safely.
  Scheme of Maneuver: The path through which connections will be established, including direction.
  Target Section: Detailed, target specific information to include IP and ports, operating systems, known risks, and specific actions to be taken on target.

Mission Documents and Materials:
Project History: Project trends, anticipated changes, and other analyst insights.
  Has the security posture changed, and if so, why?
  Known successes and failures that can be learned from
Previous Op Notes: Notes taken during previous missions
  Descriptions of threats
  Benign processes that have been previously vetted
  Target-specific idiosyncrasies.
Non-Standard Database (NSDB): Detailed descriptions of and recommendations for known threats
  What risks have previously been encountered on mission target?
  What risks have previously been encountered in the network?
  Is the target on hold?
  Is the project on hold?

Guidance:
Official policies, practices, TTPs, and how-to information for tools, techniques, operating systems, threats, and other relevant information.
  Dos/Don’ts
  Expectations
  Safe/Unsafe tool use
Daily Reads: Recent updates to policies and TTPs that have not yet been integrated into Guidance pages.
  Updates regularly
  Supersedes Guidelines

Pre-Op Checklist:
  Review the mission plan
  Review relevant guidance (MP, Daily Reads, Confluence, NSDB, etc)
  Prepare your operational environment
    Connect to OpStation
    Create STUDENT DIRECTORY: /student14_<dd-mm-yy>_<op#>
    cd into STUDENT DIRECTORY
    Create an opnotes file with: vim notes_<dd-mm-yy>
    Create a NSDB file with: vim NSDB_<dd-mm-yy>
    Script all target terminal windows with: scriptme or script -af termscreen.$$    -$$ Displays the process ID of the current shell
      Note: opnotes and NSDB are not on target. Do NOT script them (Don't script creation of opnotes and NSDB files)!
  Conduct pre-brief/IP verification with MC
(Script should be running before 0830; script then ssh into T1) (script should be running for each target +1 for scans)

Screen Discipline:
Left/Right Discipline: Creating clear separation between work areas.
Left Side: Operational space.
  Windows on target
  Anything else that is literally on target or touches target
Right Side: Work space.
  Op Notes
  Local terminals
  Op Plan
  Team Chat Windows
  Guidelines and other References
  Google

Order of Operations:
  Access Vetting
    Will ALWAYS be conducted on any host not completely within our control
    Is it safe to be here?
    Is it safe to take actions?
    Is it safe to redirect from here?
  Vetting complete - all clear
    Even though each risk has individually been approved, report vetting completion to ensure MC can make risk decisions on the sum of all known risks
  Survey (if required)
    Though similar to access vetting, the commands are more in depth and reveal a deeper interest in the machine, potentially revealing future plans and interests
  Collection (if required)
    Provides a much clearer picture to observers our intentions and interests
  (Other actions if required)
    Could be any operational task.
    Consult MC/Analyst to see when you should take these actions.
    Often include enabling actions
    Scans happen here
  Redirection (if required)
    After completing other actions on target
    Touching other devices introduces unknown risks
  Effect (if required)
  D4M: performing these before redirection could prevent redirection
  May be high profile/increase risk, and thus should be done last to minimize exposure
  (Other actions if required)
    Could be any operational task, but at this phase, typically clean-up and resets. Consult MC/Analyst to see when you should take these actions.
  Exit vetting
    What bread crumbs did we leave behind?
    How easy can actions be forensically reconstructed?
    What can we do about it?
  Exit vetting complete - Exit
    Disconnect AS SOON AS THE TARGET IS NO LONGER NEEDED
    No simultaneous connections from the same redirector unless absolutely necessary!

OpNotes:
Op notes are an technically focused document used as reference during the mission, and after the mission. These notes provide notable information and details another operator may use as reference when next accessing the device or to provide quick details in case of some form of review.

Do Record:
  Mission start/end time
  Time of each connection to and disconnection from each target
  Start and end timestamps of "Upon Connection" and "Before Disconnect" vetting command sections
  File hashes
  Device identifiers (mac/IP/hostnames…)
  Nonstandard references
  Unusual/Unexpected target information

Do Not Record:
  Names
  Titles (i.e. SFC or Cpt)
  Positions (i.e. SWO or Analyst)
  Any reference to a group (i.e. “Permission granted to ….”)
  Personal IDs (i.e. SIDs)
  Any other non-target identifiers
  Portions of the MP (scheme, creds, ssh port are allowed in OpNotes)

Post-Op Checklist:
  DEBRIEF submitted to MC
  Archive your op station
    All files collected, edited, used by student must be located in STUDENT DIRECTORY
    Save and Close NSDB and opnotes files: <esc>: wq!<enter>
    cd out of the STUDENT DIRECTORY: cd ..
    Exit terminal scripts by running “exit”
    Zip everything up: tar -cvf <studentdir>.tar <studentdir>
    Push tar to server: scp <studentdir>.tar student#@10.50.29.204:~
    Password: password# (no leading zeros for student# or password#)
  Confirm tarball submission and await feedback

Kali OpStation:
ssh -p 22014 root@10.50.30.29

alias kalimaster='ssh -MS /tmp/kali -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null root@10.50.30.29'
alias kali='ssh -S /tmp/kali dummy'

























