***MISSION DEBRIEF***
Operator: LCpl Bonestroo
Operation: BB01
MC: MC2
Analyst: Analyst2
Description: The goal of the operation was to identify path to ADMIN2 workstation. If successfully accessed, pivot from ADMIN2 to any discovered mail servers. Intelligence reporting suggests there are two operational mail servers. The operation was overall successful. Operator redirected from EXT_RTR to FILESVR to Vyos2 to ADMIN2 to T5 mail server back to ADMIN2 and redirected to T6 mail server. T1 had remote logging. T2 had a privileged user, malware, and abnormal logging; operator removed the abnormal logging log. T3 appeared to be a clean box. T4 abnormal logging; operator conducted a device survey, collect the current user's ssh keys, and performed a network discovery in order to find T5 and T6. T5 had a security product; operator conducted a device survey, cataloged the accounts, and collected all emails before exit vetting and backing out to T4. T6 had a security product and abnormal logging; operator conducted a device survey, cataloged the accounts, and collected all emails before exit vetting and disconnecting from the network.


Result: PASS


Date:2024-05-17 
Start time: 0900
End time: 1500

=========================
T1: 10.50.34.234
=========================
X-----------------------
NSDB:

Abnormal Logging
  Provide process name/options, PID, Parent ID, user
  Name: rsyslog PID: 9052 PPID: 1 User: root
  Provide location of configuration file and it's abnormal or irregular contents - /etc/rsyslog.conf
  Provide hostname or IP of where logs are being sent - 10.50.22.142
  Provide any network connections opened/established by abnormal logging - unconnected 0.0.0.0:34039  0.0.0.0:*
  Provide brief description of the abnormal, irregular or remote logging and a link to open source documentation if available. - rsyslog is remote logging to 10.50.22.142 on port 514, sending all logs.
  Recommendation - CM; we have already been caught; we are just doing normal commands on this box and redirecting.




MC:

*****Abnormal Logging Report*****
Target: T1: 10.50.34.234
Name - rsyslog
PID - 9052
PPID - 1
User - root
Location of config file - /etc/rsyslog.conf
Remote IP (hostname if IP cannot be identified) - 10.50.22.142
Network connections - unconnected 0.0.0.0:34039  0.0.0.0:*
Documentation - https://www.tenable.com/audits/items/CIS_Red_Hat_EL5_v2.2.1_L1.audit:056c4e6e4f4a36d4be92c5d7cee4f608
Description - rsyslog is remote logging to 10.50.22.142 on port 514, sending all logs.
Recommendation - CM; we have already been caught; we are just doing normal commands on this box and redirecting.
*****End of Report*****




------------------------X
=========================

=========================
T2: 10.20.169.13
=========================
X-----------------------
NSDB:

Privileged Users
  Target - Where did you see this user? - T2: 10.20.169.13 
  User - What is their username? - Administrator
  Access time - How long have they been on? - 5/17/2024 11:50 AM
  Access method - Did they access locally? Remotely? - local
    Provide all relevant details - console login, no network connection
  Privileges - What are they capable of doing? - Administrators have complete and unrestricted access to the computer/domain
  Activity - What are they currently doing? - Admin is logged in and active; running rvlkl.exe (Keylogger) from a terminal/command prompt
  Recommendation - CM; we are just running basic commands and then redirecting; be cautious for any future ops if planning on doing any effects.

Malware
  Provide process name/options, PID, Parent ID, user, and hash
  Name: rvlkl.exe PID: 392 PPID: 3900 User: Administrator
  Hash: b09c3b6b4eea27786b99038235d4164f
  Provide file type of malware binary and supporting files - executable
  Provide any associated logs generated by malware - C:\ProgramData\rvlkl\log.css
  Provide location and lines of any persistence mechanisms - N/A
  Provide full path of malware files or support files - C:\Windows\System32\rvlkl.exe; C:\ProgramData\rvlkl\
  Provide any network connections opened/established by malware - N/A
  Provide any identifiable text - N/A
  Provide any/all modules/.dlls/etc loaded by malware - N/A
  Provide brief description of malware purpose/actions and capabilities - Records all the users activities on Windows computers. Revealer Keylogger combines keystroke logging, screenshot capture, and remote monitoring.
  Provide link to open source documentation if available - https://www.logixoft.com/en-us/index
  Recommendation - CM; we are just running basic commands and then redirecting; be cautious for any future ops if planning on doing any effects.

Abnormal Logging
  Provide process name/options, PID, Parent ID, user
  Name: WIN.INTRUDER.DOSKEY PID: N/A PPID: N/A User: 
  Provide location of configuration file and it's abnormal or irregular contents - C:\windows\WIN.INTRUDER.DOSKEY; %HOMEPATH%\IntruderLog.txt
  Provide hostname or IP of where logs are being sent - N/A
  Provide any network connections opened/established by abnormal logging - N/A
  Provide brief description of the abnormal, irregular or remote logging and a link to open source documentation if available. - alias setup to log hostname, time, date, user whenever someone attempts to run dir; also displays Hello Intruder! instead of normal dir output.
https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_aliases?view=powershell-7.4
  Recommendation - CM; can just switch to PowerShell to avoid using dir and use gci instead.


MC:

*****Privileged User Report*****
Target: T2: 10.20.169.13
User - Administrator
Access Time - 5/17/2024 11:50 AM
Access Method - local
Privileges - Administrators have complete and unrestricted access to the computer/domain
Activity - Admin is logged in and active; running rvlkl.exe (Keylogger) from a terminal/command prompt
Description - Admin is actively logged in and has been for a little over an hour. They have a console login and are running rvlkl.exe (Keylogger).
Recommendation - CM; we are just running basic commands and then redirecting; be cautious for any future ops if planning on doing any effects.
*****End of Report*****

*****Malware Report*****
Target: T2: 10.20.169.13
Name - rvlkl.exe
Hash - b09c3b6b4eea27786b99038235d4164f
PID - 392
PPID - 3900
User - Administrator
File type - executable
Supporting files - C:\ProgramData\rvlkl\
Associated Logs - C:\ProgramData\rvlkl\log.css
Persistence - N/A
Documentation - https://www.logixoft.com/en-us/index
Description - Records all the users activities on Windows computers. Revealer Keylogger combines keystroke logging, screenshot capture, and remote monitoring.
Recommendation - CM; we are just running basic commands and then redirecting; be cautious for any future ops if planning on doing any effects.
*****End of Report*****

*****Abnormal Logging Report*****
Target: T2: 10.20.169.13
Name - WIN.INTRUDER.DOSKEY
PID - N/A
PPID - N/A
User - N/A
Location of config file - C:\windows\WIN.INTRUDER.DOSKEY; %HOMEPATH%\IntruderLog.txt
Remote IP (hostname if IP cannot be identified) - N/A
Network connections - N/A
Documentation - https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_aliases?view=powershell-7.4
Description - alias setup to log hostname, time, date, user whenever someone attempts to run dir; also displays Hello Intruder! instead of normal dir output.
Recommendation - CM; can just switch to PowerShell to avoid using dir and use gci instead.
*****End of Report*****


------------------------X
=========================

=========================
T3: 10.20.169.239
=========================
X-----------------------
NSBD:

Clean Box



MC:





------------------------X
=========================

=========================
T4: 192.186.169.133
=========================
X-----------------------
NSDB:

Abnormal Logging
  Provide process name/options, PID, Parent ID, user
  Name: pacct PID: N/A PPID: N/A User: root
  Provide location of configuration file and it's abnormal or irregular contents - /var/account/pacct
  Provide hostname or IP of where logs are being sent - N/A
  Provide any network connections opened/established by abnormal logging - N/A
  Provide brief description of the abnormal, irregular or remote logging and a link to open source documentation if available. - Process accounting is the method of recording and summarizing commands executed on Linux
https://www.syslog-ng.com/technical-documents/doc/syslog-ng-open-source-edition/3.16/release-notes/pacct-collecting-process-accounting-logs-on-linux
  Recommendation - CM; we have already been caught and we are just running basic commands.




MC:

*****Abnormal Logging Report*****
Target: T4: 192.186.169.133
Name - pacct
PID - N/A
PPID - N/A
User - root
Location of config file - /var/account/pacct
Remote IP (hostname if IP cannot be identified) - N/A
Network connections - N/A
Documentation - https://www.syslog-ng.com/technical-documents/doc/syslog-ng-open-source-edition/3.16/release-notes/pacct-collecting-process-accounting-logs-on-linux
Description - Process accounting is the method of recording and summarizing commands executed on Linux
Recommendation - CM; we have already been caught and we are just running basic commands.
*****End of Report*****




------------------------X
=========================

=========================
T5: 10.101.169.30
=========================
X-----------------------
NSDB:

Security Products
  Name and version of the product - COMODO ver 12.0.0.6882
  Installation folder - C:\Program Files\COMODO; C:\Program Files (x86)\Comodo; c:\comodo.exe
  Directory location of associated logs - C:\Documents and Settings\All Users\Application Data\Comodo; C:\Documents and Settings\All Users\Application Data\Comodo\Firewall Pro
  Timestamp of all associated log files - 05/17/2024  01:26 PM; 05/17/2024  04:01 PM 
  Cloud based?; no
  Can we read the logs?; no
    If Yes, put the most recent 5 lines of logs in your NSDB File
    If No, why? - Empty
  Recommendation - CM; we are not putting any tools or other products on this box; will not affect our mission.




MC:

*****Security Product Report*****
Target: T5: 10.101.169.30
Name - COMODO
Version - 12.0.0.6882
(WIN) Primary registry key - HKEY_LOCAL_MACHINE\software\COMODO
(NIX) Config file or install directory - N/A
Documentation - https://www.comodo.com/
Recommendation - CM; we are not putting any tools or other products on this box; will not affect our mission.
*****End of Report*****




-----------------------X
=========================

=========================
T6: 10.101.169.35
=========================
X-----------------------
NSDB:

Security Products
  Name and version of the product - SELinux ver 33
  Installation folder - /etc/selinux
  Directory location of associated logs - /var/log/audit/audit.log
  Timestamp of all associated log files - May  17 17:04
  Cloud based?; no
  Can we read the logs?; yes
    If Yes, put the most recent 5 lines of logs in your NSDB File
type=CRED_DISP msg=audit(1715965465.364:1281): pid=20424 uid=0 auid=1014 ses=13 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 msg='op=PAM:setcred grantors=pam_env,pam_localuser,pam_unix acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=/dev/pts/3 res=success'UID="root" AUID="askar14"
type=USER_ACCT msg=audit(1715965652.720:1282): pid=20432 uid=1014 auid=1014 ses=13 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 msg='op=PAM:accounting grantors=pam_unix,pam_localuser acct="askar14" exe="/usr/bin/sudo" hostname=? addr=? terminal=/dev/pts/3 res=success'UID="askar14" AUID="askar14"
type=USER_CMD msg=audit(1715965652.720:1283): pid=20432 uid=1014 auid=1014 ses=13 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 msg='cwd="/home/useraccounts/askar14" cmd=7461696C202D6E2035202F7661722F6C6F672F61756469742F61756469742E6C6F67 exe="/usr/bin/sudo" terminal=pts/3 res=success'UID="askar14" AUID="askar14"
type=CRED_REFR msg=audit(1715965652.720:1284): pid=20432 uid=0 auid=1014 ses=13 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 msg='op=PAM:setcred grantors=pam_env,pam_localuser,pam_unix acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=/dev/pts/3 res=success'UID="root" AUID="askar14"
type=USER_START msg=audit(1715965652.722:1285): pid=20432 uid=0 auid=1014 ses=13 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 msg='op=PAM:session_open grantors=pam_keyinit,pam_limits,pam_systemd,pam_unix acct="root" exe="/usr/bin/sudo" hostname=? addr=? terminal=/dev/pts/3 res=success'UID="root" AUID="askar14"

Recommendation - CM; SELinux is enabled and in enforcing mode.  It will log our actions, but it does not prevent us from continuing, and we are only running basic commands.

Abnormal Logging
  Provide process name/options, PID, Parent ID, user
  Name: rsyslog PID: 887 PPID: 1 User: root
  Provide location of configuration file and it's abnormal or irregular contents - /etc/rsyslog.conf
  Provide hostname or IP of where logs are being sent - not in /etc/hosts, conf says *.* @@remote-host:514 in /etc/rsyslog.conf
  Provide any network connections opened/established by abnormal logging - None shown when ss command was run
  Provide brief description of the abnormal, irregular or remote logging - Rsyslog is enabled with remote logging. It is sending all logs a remote host using port 514
  Documentation - https://www.rsyslog.com/doc/index.html
  Recommendation - CM; we have already been caught, and we were not really concerned with the logs anyway; running basic commands and disconnecting.



MC:

*****Security Product Report*****
Target: T6: 10.101.169.35
Name - SELinux
Version - 33
(WIN) Primary registry key - N/A
(NIX) Config file or install directory - /etc/selinux
Documentation - https://www.selinuxproject.org/
Recommendation - CM; SELinux is enabled and in enforcing mode.  It will log our actions, but it does not prevent us from continuing, and we are only running basic commands.
*****End of Report*****

*****Abnormal Logging Report*****
Target: T6: 10.101.169.35
Name - rsyslog
PID - 887
PPID - 1
User - root
Location of config file - /etc/rsyslog.conf
Remote IP (hostname if IP cannot be identified) - not in /etc/hosts, conf says *.* @@remote-host:514 in /etc/rsyslog.conf
Network connections -  None shown when ss command was run
Documentation -https://www.rsyslog.com/doc/index.html
Description - Rsyslog is enabled with remote logging. It is sending all logs a remote host using port 514
Recommendation - CM; we have already been caught, and we were not really concerned with the logs anyway; running basic commands and disconnecting.
*****End of Report*****

-----------------------X
=========================

